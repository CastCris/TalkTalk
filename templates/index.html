{% extends "default/layout.html" %}
{% block title %}Index{% endblock %}
{% block content %}

<link rel="stylesheet" href="{{ url_for("static", filename="index.css") }}">

<div id="rooms">
    <a href="{{ url_for("room_create") }}">create room</a>
    <ul id="rooms_able"></ul>
</div>

<div id="chat">
    <form id="chat_forms">
        <input type="text" autocomplete="off" placeholder="Do the world a better place" id="chat_input">
        <button type="submit" style="display:none"></button>
    </form>

    <div id="chat_message">
    </div>
</div>

<script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>
<script>
    const socket=io('http://localhost:5000');
    const room_curr=0;

    const OUTPUT_BOX=document.getElementById("chat_message");
    const INPUT_BOX=document.getElementById("chat_input");
    const FORMS=document.getElementById("chat_forms");

    socket.on('message', (msg) => {
        OUTPUT_BOX.innerHTML = msg + '<br>' + OUTPUT_BOX.innerHTML;
    });

    FORMS.addEventListener('submit', (e) => {
        e.preventDefault();

        if(!INPUT_BOX.value)
            return;
        socket.emit('message', {
            message:INPUT_BOX.value,
            room:room_curr
        });

        INPUT_BOX.value='';
    });

</script>

{% endblock %}
